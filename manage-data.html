<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Manage Data - Fitness Tracker</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/manage-data-style.css">
    <link rel="icon" href="images/eagle.png" type="image/png">
</head>
<body>
    <div id="toast-container"></div>
    <svg style="display: none;">
        <!-- MODIFICATION: Added new back arrow icon -->
        <symbol id="icon-arrow-back" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 6L9 12L15 18"/>
        </symbol>
        <symbol id="icon-close" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></symbol>
        <symbol id="icon-merge" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 10l-4 4m0-4l4 4"/>
            <path d="M2,12 A10,10 0 0,1 22,12"/>
            <path d="M2,12 A10,10 0 0,0 22,12"/>
            <path d="M12,2 V22"/>
        </symbol>
        <symbol id="icon-trash" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 6h18m-2 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
            <line x1="10" y1="11" x2="10" y2="17"/>
            <line x1="14" y1="11" x2="14" y2="17"/>
        </symbol>
    </svg>

    <div class="container">
        <header>
            <!-- MODIFICATION: Updated header structure -->
            <div class="page-header">
                <a href="progress-analytics.html" class="back-icon-btn" title="Back">
                    <svg><use xlink:href="#icon-arrow-back"></use></svg>
                </a>
                <h1>Manage Exercises</h1>
                <div id="user-info" style="display: none;">
                    <img id="user-photo">
                </div>
            </div>
        </header>

        <div id="app-content" style="display: none;">
            <div id="main-content-wrapper" style="display: none;">
                <p class="page-description">Select exercises to merge or delete. Merging is useful for duplicates (e.g., "Bench Press" vs "Benchpress"). Deleting will remove all records of an exercise from your history.</p>
                
                <div class="toolbar">
                    <button id="delete-btn" class="action-btn destructive-btn" disabled>
                        <svg><use xlink:href="#icon-trash"></use></svg>
                        <span class="btn-text">Delete</span>
                        <div class="loader"></div>
                    </button>
                    <button id="merge-btn" class="action-btn" disabled>
                        <svg><use xlink:href="#icon-merge"></use></svg>
                        <span class="btn-text">Merge</span>
                        <div class="loader"></div>
                    </button>
                </div>

                <div id="exercise-list-container" class="glass-card">
                    <div id="exercise-list-header">
                        <label for="select-all-checkbox">Exercise Name</label>
                        <span>Workouts</span>
                    </div>
                    <div id="exercise-list">
                        <div class="loader-container"><div class="loader"></div></div>
                    </div>
                </div>
            </div>
            <div id="skeleton-loader">
                <div class="skeleton sk-description"></div>
                <div class="sk-toolbar">
                    <div class="skeleton sk-button"></div>
                    <div class="skeleton sk-button"></div>
                </div>
                <div class="glass-card sk-list-container">
                    <div class="skeleton sk-list-header"></div>
                    <div class="skeleton sk-list-item"></div>
                    <div class="skeleton sk-list-item"></div>
                    <div class="skeleton sk-list-item"></div>
                    <div class="skeleton sk-list-item"></div>
                    <div class="skeleton sk-list-item"></div>
                </div>
            </div>
        </div>

        <div id="sign-in-prompt" style="display: none; text-align: center; margin-top: 50px;">
            <h2>Please Sign In</h2>
            <p>You need to be signed in to manage your data.</p>
            <a href="index.html" class="action-btn" style="background-color: var(--system-blue); color: var(--text-on-action);">Go to Sign In Page</a>
        </div>
    </div>

    <div class="modal-overlay" id="merge-modal-overlay">
        <div class="overlay-content glass-card">
            <div class="overlay-header">
                <h2>Merge Exercises</h2>
                <button class="icon-btn" id="close-merge-modal-btn"><svg><use xlink:href="#icon-close"></use></svg></button>
            </div>
            <div class="overlay-body">
                <p>You are about to merge the selected exercises. Choose the final, correct name for them.</p>
                <div class="form-group">
                    <label for="target-name-select">New Name</label>
                    <select id="target-name-select"></select>
                </div>
                <div class="form-group" id="custom-name-group" style="display: none;">
                    <label for="custom-name-input">Custom Name</label>
                    <input type="text" id="custom-name-input" placeholder="Enter the new exercise name">
                </div>
                <div id="merge-summary"></div>
            </div>
            <div class="overlay-footer">
                <button id="confirm-merge-btn" class="action-btn" style="background-color: var(--system-blue); color: var(--text-on-action);">
                    <span class="btn-text">Confirm Merge</span>
                    <div class="loader"></div>
                </button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <!-- MODIFICATION: Linking to the new JavaScript module -->
    <script type="module" src="js/manage-data.js"></script>
</body>
</html>
